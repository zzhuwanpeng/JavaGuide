| 问题分类       | 描述                                                         | 触发原因                                                     | 解决方案或注意点                                           |
|----------------|--------------------------------------------------------------|--------------------------------------------------------------|------------------------------------------------------------|
| 动态扩容引起的空间震荡 | 服务启动初期GC次数多，频繁调整堆内存大小                     | `-Xms` 和 `-Xmx` 不一致，空间不足或过多时调整                   | 调整 `-XX:MinHeapFreeRatio` 和 `-XX:MaxHeapFreeRatio` 避免频繁GC |
| 显式GC问题     | 无明显原因触发GC                                             | 代码中手动调用 `System.gc`                                    | 避免在代码中随意调用 `System.gc`                          |
| MetaSpace区OOM | MetaSpace区持续增长，GC无法释放                             | 类加载器存活导致类元数据无法回收                            | 设置 `-XX:MetaSpaceSize` 和 `-XX:MaxMetaSpaceSize` 防止扩容    |
| 过早晋升       | 对象年龄较小即晋升到老年代                                     | FGC频繁，Old区变化大                                          | 检查YGC频繁原因，优化对象分配和回收策略                      |
| 新生代过小     | 导致YGC时间增加，次数频繁                                     | Eden区过小，对象快速晋升                                       | 调整新生代大小，优化对象分配速率                            |
| 分配速度过大   | 观察到内存分配速度波动                                        | 可能由大量数据加载导致                                          | 监控网络流量和中间件日志，优化数据加载                     |
| ** CMS Old GC频繁 ** | 老年代频繁GC，但每次耗时不长                                 | 后台线程不断检测是否达到CMS GC条件                             | 调整 `-XX:CMSWaitDuration` 减少检测频率                      |
| 单次CMS Old GC耗时长 | CMS GC单次STW超过1000ms，影响系统                        | 主要发生在Init Mark和Final Remark阶段                         | 优化GC日志中的耗时阶段                                     |
| 内存碎片/收集器退化 | 内存碎片导致空间分配和利用效率降低，收集器退化               | 内存碎片化，老年代空间不足                                      | 使用带压缩的GC算法，减少内存碎片                            |
| 晋升失败       | 老年代空间不足，无法存放新晋升的对象                           | 老年代内存碎片或空间不足                                      | 优化内存分配策略，减少内存碎片                              |
| 增量收集担保失败 | 老年代剩余空间小于YGC晋升平均大小和当前使用大小              | 晋升不安全，直接进行FGC                                      | 监控YGC和FGC，优化内存使用                               |
| 显式GC         | 代码中显式调用GC导致的GC问题                                 | `System.gc` 被调用                                              | 避免在代码中随意调用 `System.gc`                          |
| ** 并发模式失败 **   | 并发CMS GC执行中，老年代空间不足                             | 浮动垃圾导致CMS无法处理                                        | 调整老年代回收阈值，减少并发模式失败                         |
| 堆外内存OOM    | Java进程使用SWAP，RES超出-Xmx                               | 堆外内存未释放                                                | 监控和优化堆外内存使用，如NIO、Netty                     |
| JNI引发的内存问题 | JNI调用导致GC被禁止，数据异常                               | 使用JNI时的线程安全问题                                        | 确保JNI使用时的线程安全，避免数据不一致                   |
| JDK的Bug（JDK-8048556） | 重复YGC问题                                                | JDK内部Bug                                                    | 关注JDK更新，修复Bug                                         |
